# 个人图库系统

## 项目说明

### 1. 项目概述

个人图库系统是一个基于 PHP 和 SQLite 开发的图片管理平台，提供了完整的图片上传、管理、浏览和搜索功能。系统采用了现代化的瀑布流布局，支持多种筛选和排序方式，同时具备完善的用户权限管理机制。

### 2. 技术栈

* **后端**: PHP 7.0+

* **数据库**: SQLite 3

* **前端**: HTML5, CSS3, JavaScript (原生)

* **样式**: 响应式设计，支持移动端和桌面端

* **图片处理**: 原生 PHP 图像处理

* **认证机制**: Session 认证

### 3. 系统架构

```
PersonalGallery/
├── admin/             # 后台管理页面
├── api/               # API 接口
├── css/               # 样式文件
├── images/            # 图片存储目录
├── includes/          # 核心功能文件
├── js/                # JavaScript 文件
├── database.db        # SQLite 数据库
├── index.php          # 前端首页
├── login.php          # 登录页面
└── upload.php         # 图片上传处理
```

### 4. 核心功能模块

#### 4.1 用户认证与权限管理

* 支持多用户系统

* 基于角色的权限控制

* 会话超时机制（1小时）

* 密码哈希加密存储

#### 4.2 图片管理

* 图片上传（支持 JPG, JPEG, PNG, GIF, WebP 格式）

* 单文件最大 100MB

* 图片分类和标签

* 图片详情查看和编辑

* 图片删除和下载

#### 4.3 图片浏览与搜索

* 瀑布流布局展示

* 多条件筛选（分类、标签、格式、版型）

* 多种排序方式（上传时间、文件大小、名称）

* 分页功能（每页 20 项）

#### 4.4 后台管理

* 用户管理

* 图库管理

* 分类管理

* 权限管理

#### 4.5 API 接口

* 分类数据获取

* 图片数据获取

* 统计数据获取

### 5. 数据库设计

系统使用 SQLite 数据库，主要包含以下表结构：

* **users**: 用户信息表

* **galleries**: 图库信息表

* **categories**: 分类信息表

* **images**: 图片信息表

* **tags**: 标签信息表

* **image\_tags**: 图片-标签关联表

* **permissions**: 权限表

* **user\_permissions**: 用户-权限关联表

### 6. 安全特性

* 输入验证和过滤

* SQL 注入防护

* 文件类型验证

* 密码哈希存储

* 会话管理

* 权限控制

### 7. 配置说明

主要配置文件位于 `includes/config.php`，包含以下关键配置：

```php
// 数据库配置
define('DB_PATH', dirname(__DIR__) . '/database.db');

// 图片存储配置
define('IMAGE_DIR', dirname(__DIR__) . '/images/');
define('IMAGE_URL', '/images/');

// 允许的图片格式
define('ALLOWED_IMAGE_TYPES', ['jpg', 'jpeg', 'png', 'gif', 'webp']);

// 最大文件大小 (100MB)
define('MAX_FILE_SIZE', 100 * 1024 * 1024);

// 分页配置
define('ITEMS_PER_PAGE', 20);

// 会话配置
define('SESSION_TIMEOUT', 3600); // 1小时
```

## 使用说明

### 1. 环境要求

* PHP 7.0 或更高版本

* SQLite 3 扩展

* GD 扩展（用于图像处理）

* 支持 URL 重写（可选，用于美化 URL）

### 2. 安装与部署

1. **克隆或下载项目**

   ```bash
   git clone <repository-url>
   cd PersonalGallery
   ```

2. **设置文件权限**

   * 确保 `images/` 目录可写

   * 确保 `database.db` 文件可写（如果不存在，系统会自动创建）

3. **启动本地服务器**

   ```bash
   php -S localhost:8000
   ```

4. **访问系统**

   * 打开浏览器访问 `http://localhost:8000`

   * 默认管理员账户：`admin` / `admin123`

### 3. 基本操作

#### 3.1 登录系统

1. 打开 `http://localhost:8000/login.php`
2. 输入用户名和密码
3. 点击登录按钮

#### 3.2 上传图片

1. 在首页选择要上传的图库
2. 点击「上传图片」按钮
3. 填写图片信息（名称、分类、标签）
4. 选择本地图片文件
5. 点击「上传」按钮

#### 3.3 浏览和搜索图片

1. 在首页选择图库
2. 使用左侧筛选条件（分类、标签、格式、版型）缩小范围
3. 选择排序方式
4. 点击图片查看详情
5. 点击分页导航切换页码

#### 3.4 管理图片

1. 查看图片详情
2. 点击「编辑」按钮修改图片信息
3. 点击「下载」按钮下载图片
4. 点击「删除」按钮删除图片

#### 3.5 后台管理

1. 登录后，点击右上角「后台管理」按钮
2. 在后台可以管理：

   * 用户（添加、编辑、删除）

   * 图库（创建、编辑、删除）

   * 分类（创建、编辑、删除）

   * 权限（分配用户权限）

### 4. 权限说明

系统采用基于角色的权限管理，主要权限包括：

* **管理员**: 拥有所有权限

* **图库管理员**: 可以管理特定图库

* **图片上传者**: 可以上传和管理自己的图片

* **普通用户**: 只能浏览和下载图片

### 5. 常见问题

#### 5.1 上传图片失败

* 检查文件大小是否超过 100MB

* 检查文件格式是否为支持的格式

* 检查 `images/` 目录是否有写入权限

#### 5.2 无法登录

* 检查用户名和密码是否正确

* 检查浏览器是否支持 Cookie

* 尝试清除浏览器缓存

#### 5.3 图片显示异常

* 检查图片文件是否存在

* 检查图片文件权限

* 检查 PHP GD 扩展是否安装

### 6. 浏览器兼容性

* Chrome 60+

* Firefox 55+

* Safari 12+

* Edge 79+

### 7. 性能优化建议

* 定期清理无用图片

* 对大量图片进行合理分类

* 考虑使用 CDN 加速图片访问

* 优化数据库查询

## 使用说明（简洁版）

### 1. 快速开始

1. **启动服务器**

   ```bash
   php -S localhost:8000
   ```

2. **访问系统**

   * 浏览器打开 `http://localhost:8000`

   * 默认账户：`admin` / `admin123`

### 2. 主要功能

#### 2.1 上传图片

* 选择图库 → 点击「上传图片」→ 填写信息 → 选择文件 → 上传

#### 2.2 浏览图片

* 选择图库 → 设置筛选条件 → 浏览瀑布流 → 点击图片查看详情

#### 2.3 管理图片

* 查看详情 → 编辑/下载/删除

#### 2.4 后台管理

* 点击「后台管理」→ 管理用户/图库/分类/权限

### 3. 键盘快捷键

* 无特定快捷键，纯鼠标操作

### 4. 退出系统

* 点击右上角「退出」按钮

* 或直接关闭浏览器（1小时后自动超时）

## 版本信息

* 当前版本: 1.0.0

* 发布日期: 2026-01-07

* 开发语言: PHP

* 授权协议: MIT

## 联系方式

如有问题或建议，请联系系统管理员。

***

**© 2024 个人图库系统. 保留所有权利。**
